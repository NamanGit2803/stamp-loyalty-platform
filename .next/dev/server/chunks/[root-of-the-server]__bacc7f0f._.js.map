{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/Project%20Files/Earning-model/stamp-card-project/stamp-loyalty-platform/app/api/shop/shopDetails/update/route.js"],"sourcesContent":["export const dynamic = \"force-dynamic\";\r\nexport const runtime = \"nodejs\";\r\n\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport async function PUT(req) {\r\n    try {\r\n        //  Lazy import prisma (build-safe)\r\n        const { default: prisma } = await import(\"@/lib/prisma\");\r\n\r\n        const body = await req.json();\r\n        const { shopId, details, enable } = body;\r\n\r\n        if (!shopId) {\r\n            return NextResponse.json(\r\n                { error: \"Shop not exist!\" },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        //  Get shop\r\n        const shop = await prisma.shop.findUnique({\r\n            where: { id: shopId },\r\n        });\r\n\r\n        if (!shop) {\r\n            return NextResponse.json(\r\n                { error: \"Shop not found\" },\r\n                { status: 404 }\r\n            );\r\n        }\r\n\r\n        let updatedShop\r\n\r\n        if (enable) {\r\n            updatedShop = await prisma.shop.update({\r\n                where: { id: shopId },\r\n                data: {\r\n                    loyaltyEnabled: !shop.loyaltyEnabled,\r\n                }\r\n            });\r\n\r\n            return NextResponse.json({\r\n                message: \"Shop updated successfully\",\r\n                shop: updatedShop,\r\n            });\r\n        }\r\n\r\n\r\n        // update details \r\n        updatedShop = await prisma.shop.update({\r\n            where: { id: shopId },\r\n            data: details,\r\n        });\r\n\r\n\r\n        return NextResponse.json({\r\n            message: \"Shop updated successfully\",\r\n            shop: updatedShop,\r\n        });\r\n\r\n    } catch (err) {\r\n        console.error(\"[update shop error]\", err);\r\n        return NextResponse.json(\r\n            { error: \"Internal server error\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAGA;AAHO,MAAM,UAAU;AAChB,MAAM,UAAU;;AAIhB,eAAe,IAAI,GAAG;IACzB,IAAI;QACA,mCAAmC;QACnC,MAAM,EAAE,SAAS,MAAM,EAAE,GAAG;QAE5B,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG;QAEpC,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAkB,GAC3B;gBAAE,QAAQ;YAAI;QAEtB;QAEA,YAAY;QACZ,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;YACtC,OAAO;gBAAE,IAAI;YAAO;QACxB;QAEA,IAAI,CAAC,MAAM;YACP,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAiB,GAC1B;gBAAE,QAAQ;YAAI;QAEtB;QAEA,IAAI;QAEJ,IAAI,QAAQ;YACR,cAAc,MAAM,OAAO,IAAI,CAAC,MAAM,CAAC;gBACnC,OAAO;oBAAE,IAAI;gBAAO;gBACpB,MAAM;oBACF,gBAAgB,CAAC,KAAK,cAAc;gBACxC;YACJ;YAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACrB,SAAS;gBACT,MAAM;YACV;QACJ;QAGA,kBAAkB;QAClB,cAAc,MAAM,OAAO,IAAI,CAAC,MAAM,CAAC;YACnC,OAAO;gBAAE,IAAI;YAAO;YACpB,MAAM;QACV;QAGA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,MAAM;QACV;IAEJ,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}