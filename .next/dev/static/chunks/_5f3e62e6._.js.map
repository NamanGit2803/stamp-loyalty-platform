{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/Project%20Files/Earning-model/stamp-card-project/stamp-loyalty-platform/stores/userStore.js"],"sourcesContent":["'use client'\r\n\r\nimport { makeAutoObservable, runInAction } from \"mobx\"\r\n\r\nclass UserStore {\r\n    user = null\r\n    loading = false\r\n    error = null\r\n\r\n\r\n    // OTP global state\r\n    otpModalOpen = false;\r\n    otpEmail = \"\";\r\n    otpPurpose = \"\";  // signup, login, reset, security, change-email…\r\n    otpVerified = false;\r\n\r\n    redirectAfterOtp = null; // after OTP verification → auto redirect somewhere\r\n\r\n    constructor() {\r\n        makeAutoObservable(this)\r\n        this.fetchUserProfile() // auto load user on refresh\r\n    }\r\n\r\n    // Register\r\n    async userSignup(formData) {\r\n        this.loading = true\r\n        this.error = null\r\n        try {\r\n            const res = await fetch(\"/api/auth/signup/userCreate\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(formData),\r\n            })\r\n            const data = await res.json()\r\n\r\n            if (!res.ok) throw new Error(data.error)\r\n\r\n            runInAction(() => {\r\n                this.user = data.user\r\n            })\r\n        } catch (err) {\r\n            runInAction(() => this.error = err.message)\r\n        } finally {\r\n            this.loading = false\r\n        }\r\n    }\r\n\r\n\r\n    // Login\r\n    async login(credentials) {\r\n        this.loading = true\r\n        this.error = null\r\n        try {\r\n            const res = await fetch(\"/api/user/login\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(credentials),\r\n            })\r\n\r\n            const data = await res.json()\r\n\r\n            if (!res.ok) throw new Error(data.error)\r\n\r\n            runInAction(() => {\r\n                this.user = data.user\r\n            })\r\n        } catch (err) {\r\n            runInAction(() => this.error = err.message)\r\n        } finally {\r\n            this.loading = false\r\n        }\r\n    }\r\n\r\n\r\n    // Auto-fetch user (browser sends cookie)\r\n    async fetchUserProfile() {\r\n        try {\r\n            const res = await fetch(\"/api/user/findUser\", {\r\n                method: \"GET\",\r\n                credentials: \"include\"\r\n            })\r\n\r\n            if (!res.ok) return\r\n\r\n            const data = await res.json()\r\n\r\n            runInAction(() => {\r\n                this.user = data\r\n            })\r\n        } catch { }\r\n    }\r\n\r\n\r\n    // Logout\r\n    async logout() {\r\n        await fetch(\"/api/user/logout\", { method: \"POST\" })\r\n        this.user = null\r\n    }\r\n\r\n\r\n    // -----------------------------\r\n    // OTP: request\r\n    // -----------------------------\r\n    async requestOtp(email, purpose, redirectUrl = null) {\r\n        this.loading = true;\r\n        this.error = null;\r\n\r\n        try {\r\n            const res = await fetch(\"/api/otp/send\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({ email, purpose }),\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (!res.ok) throw new Error(data.error || \"Failed to send OTP\");\r\n\r\n            runInAction(() => {\r\n                this.otpEmail = email;\r\n                this.otpPurpose = purpose;\r\n                this.redirectAfterOtp = redirectUrl;\r\n                this.otpModalOpen = true;\r\n            });\r\n        } catch (err) {\r\n            runInAction(() => (this.error = err.message));\r\n        } finally {\r\n            this.loading = false;\r\n        }\r\n    }\r\n\r\n    closeOtp() {\r\n        this.otpModalOpen = false;\r\n    }\r\n\r\n    // -----------------------------\r\n    // OTP: verify\r\n    // -----------------------------\r\n    async verifyOtp(code) {\r\n        this.loading = true;\r\n        this.error = null;\r\n\r\n        try {\r\n            const res = await fetch(\"/api/otp/verify\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({\r\n                    email: this.otpEmail,\r\n                    code,\r\n                    purpose: this.otpPurpose,\r\n                }),\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (!res.ok) throw new Error(data.error || \"Invalid OTP\");\r\n\r\n            runInAction(() => {\r\n                this.otpVerified = true;\r\n                this.otpModalOpen = false;\r\n            });\r\n\r\n            // automatic redirect if configured\r\n            if (this.redirectAfterOtp) {\r\n                window.location.href = this.redirectAfterOtp;\r\n            }\r\n\r\n            return true;\r\n        } catch (err) {\r\n            runInAction(() => (this.error = err.message));\r\n            return false;\r\n        } finally {\r\n            this.loading = false;\r\n        }\r\n    }\r\n}\r\n\r\nexport const userStore = new UserStore()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":["file:///E:/Project%20Files/Earning-model/stamp-card-project/stamp-loyalty-platform/stores/shopStore.js"],"sourcesContent":["import { makeAutoObservable, runInAction } from \"mobx\";\r\n\r\nclass ShopStore {\r\n  shops = [];      \r\n  loading = false;\r\n  error = null;\r\n\r\n  constructor() {\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n\r\n  // CREATE NEW SHOP\r\n  async createShop(shopData) {\r\n    this.loading = true;\r\n    this.error = null;\r\n\r\n    try {\r\n      const res = await fetch(\"/api/auth/signup/shopCreate\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(shopData),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok) throw new Error(data.error || \"Shop creation failed\");\r\n\r\n      runInAction(() => {\r\n        // ADD NEW SHOP TO SHOP LIST\r\n        this.shops.push(data.shop);  \r\n      });\r\n\r\n      return data.shop;\r\n\r\n    } catch (err) {\r\n      runInAction(() => {\r\n        this.error = err.message;\r\n      });\r\n\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  // SET ALL SHOPS\r\n  setShops(shops) {\r\n    this.shops = shops;\r\n  }\r\n\r\n  // ACTIVE SHOP (OPTIONAL FEATURE)\r\n  get activeShop() {\r\n    return this.shops[0] || null;\r\n  }\r\n}\r\n\r\nexport const shopStore = new ShopStore();\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;IACJ,QAAQ,EAAE,CAAC;IACX,UAAU,MAAM;IAChB,QAAQ,KAAK;IAEb,aAAc;QACZ,IAAA,oKAAkB,EAAC,IAAI;IACzB;IAGA,kBAAkB;IAClB,MAAM,WAAW,QAAQ,EAAE;QACzB,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,KAAK,GAAG;QAEb,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,+BAA+B;gBACrD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAE3C,IAAA,6JAAW,EAAC;gBACV,4BAA4B;gBAC5B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI;YAC3B;YAEA,OAAO,KAAK,IAAI;QAElB,EAAE,OAAO,KAAK;YACZ,IAAA,6JAAW,EAAC;gBACV,IAAI,CAAC,KAAK,GAAG,IAAI,OAAO;YAC1B;QAEF,SAAU;YACR,IAAI,CAAC,OAAO,GAAG;QACjB;IACF;IAEA,gBAAgB;IAChB,SAAS,KAAK,EAAE;QACd,IAAI,CAAC,KAAK,GAAG;IACf;IAEA,iCAAiC;IACjC,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI;IAC1B;AACF;AAEO,MAAM,YAAY,IAAI"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///E:/Project%20Files/Earning-model/stamp-card-project/stamp-loyalty-platform/stores/StoreProvider.js"],"sourcesContent":["\"use client\"\r\nimport { createContext, useContext } from \"react\"\r\n\r\n// Import all stores here\r\nimport { userStore } from \"./userStore\"\r\nimport { shopStore } from \"./shopStore\"\r\n// Combine stores in one object\r\nconst store = {\r\n  userStore,\r\n  shopStore\r\n}\r\n\r\n// Create React Context\r\nconst StoreContext = createContext(store)\r\n\r\n// Provider component\r\nexport const StoreProvider = ({ children }) => {\r\n  return (\r\n    <StoreContext.Provider value={store}>\r\n      {children}\r\n    </StoreContext.Provider>\r\n  )\r\n}\r\n\r\n// Hook to use stores anywhere\r\nexport const useStore = () => useContext(StoreContext)\r\n"],"names":[],"mappings":";;;;;;;AACA;AAEA,yBAAyB;AACzB;AACA;;;AALA;;;;AAMA,+BAA+B;AAC/B,MAAM,QAAQ;IACZ,WAAA,mIAAS;IACT,WAAA,mIAAS;AACX;AAEA,uBAAuB;AACvB,MAAM,6BAAe,IAAA,8KAAa,EAAC;AAG5B,MAAM,gBAAgB,CAAC,EAAE,QAAQ,EAAE;IACxC,qBACE,6LAAC,aAAa,QAAQ;QAAC,OAAO;kBAC3B;;;;;;AAGP;KANa;AASN,MAAM,WAAW;;IAAM,OAAA,IAAA,2KAAU,EAAC;AAAY;GAAxC"}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///E:/Project%20Files/Earning-model/stamp-card-project/stamp-loyalty-platform/components/ui/sonner.tsx"],"sourcesContent":["'use client'\n\nimport { useTheme } from 'next-themes'\nimport { Toaster as Sonner, ToasterProps } from 'sonner'\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = 'system' } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps['theme']}\n      className=\"toaster group\"\n      style={\n        {\n          '--normal-bg': 'var(--popover)',\n          '--normal-text': 'var(--popover-foreground)',\n          '--normal-border': 'var(--border)',\n        } as React.CSSProperties\n      }\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKA,MAAM,UAAU,CAAC,EAAE,GAAG,OAAqB;;IACzC,MAAM,EAAE,QAAQ,QAAQ,EAAE,GAAG,IAAA,+JAAQ;IAErC,qBACE,6LAAC,sJAAM;QACL,OAAO;QACP,WAAU;QACV,OACE;YACE,eAAe;YACf,iBAAiB;YACjB,mBAAmB;QACrB;QAED,GAAG,KAAK;;;;;;AAGf;GAjBM;;QACyB,+JAAQ;;;KADjC"}}]
}