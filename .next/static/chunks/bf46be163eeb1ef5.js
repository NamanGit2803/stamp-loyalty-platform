(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37727,e=>{"use strict";var t=e.i(41947);e.s(["X",()=>t.default])},34905,e=>{"use strict";function t(e,a=!1){if(!e)return"-";let s=new Date(e),r=new Date,l=new Date(s.getFullYear(),s.getMonth(),s.getDate()),i=Math.floor((new Date(r.getFullYear(),r.getMonth(),r.getDate())-l)/864e5);if(!1==a){if(0===i)return"Today";if(1===i)return"Yesterday";if(i>1&&i<7)return`${i} days ago`}return s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}function a(e){return new Date(e).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(","," •").toUpperCase()}e.s(["FormatLastVisit",()=>t,"FormatToIST",()=>a])},47627,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function r({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function l({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function i({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function n({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function c({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>l,"TableCell",()=>c,"TableHead",()=>n,"TableHeader",()=>r,"TableRow",()=>i])},95775,e=>{"use strict";var t=e.i(43476),a=e.i(23750);let s=(0,e.i(75254).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var r=e.i(37727);function l({value:e,onChange:l,placeholder:i="Search..."}){return(0,t.jsx)("div",{className:"w-sm",children:(0,t.jsxs)("div",{className:"relative bg-background",children:[(0,t.jsx)(s,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(a.Input,{value:e,onChange:e=>l(e.target.value),placeholder:i,className:"pl-9 pr-9"}),e&&(0,t.jsx)("button",{type:"button",onClick:()=>l(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":"Clear search",children:(0,t.jsx)(r.X,{className:"h-4 w-4"})})]})})}e.s(["SearchBar",()=>l],95775)},88997,e=>{"use strict";var t=e.i(71645);function a(e,s=500){let[r,l]=(0,t.useState)(e);return(0,t.useEffect)(()=>{let t=setTimeout(()=>{l(e)},s);return()=>clearTimeout(t)},[e,s]),r}e.s(["useDebounce",()=>a])},97447,e=>{"use strict";var t=e.i(43476);e.i(71470);var a=e.i(41721),s=e.i(41019),r=e.i(62870),l=e.i(67881);let i=(0,a.observer)(({page:e,setPage:a})=>{let{shopStore:i}=(0,s.useStore)();return(0,t.jsxs)("div",{className:"flex justify-between items-center pt-2",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",e," of ",i.pagination?.totalPages," — ",i.pagination?.total," items"]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Rows:"}),(0,t.jsxs)(r.Select,{value:String(i.pagination?.limit||10),onValueChange:e=>{i.pagination.limit=Number(e),a(1)},children:[(0,t.jsx)(r.SelectTrigger,{className:"w-[80px]",children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"10",children:"10"}),(0,t.jsx)(r.SelectItem,{value:"20",children:"20"}),(0,t.jsx)(r.SelectItem,{value:"50",children:"50"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Button,{disabled:1===e,onClick:()=>a(e-1),children:"Prev"}),(0,t.jsx)(l.Button,{disabled:e===i.pagination?.totalPages,onClick:()=>a(e+1),children:"Next"})]})]})]})});e.s(["default",0,i])},84031,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(23750),r=e.i(47627),l=e.i(70065),i=e.i(50216),n=e.i(34905);function c({rewardsData:e,loading:a}){return(0,t.jsxs)(l.Card,{className:"overflow-hidden card",children:[a&&(0,t.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,t.jsx)(i.Spinner,{className:"h-6 w-6 text-primary"})}),!a&&(0,t.jsxs)(r.Table,{children:[(0,t.jsx)(r.TableHeader,{className:"bg-muted/40 sticky top-0 z-10",children:(0,t.jsxs)(r.TableRow,{children:[(0,t.jsx)(r.TableHead,{className:"text-primary",children:"Customer"}),(0,t.jsx)(r.TableHead,{className:"text-primary",children:"Reward Id"}),(0,t.jsx)(r.TableHead,{className:"text-primary",children:"Mobile"}),(0,t.jsx)(r.TableHead,{className:"text-primary",children:"Reward"}),(0,t.jsx)(r.TableHead,{className:"text-primary",children:"Earned On"})]})}),(0,t.jsx)(r.TableBody,{children:e?.map(e=>(0,t.jsxs)(r.TableRow,{className:"hover:bg-muted/30 transition-colors",children:[(0,t.jsx)(r.TableCell,{className:"py-3 font-medium",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary/10 text-primary flex items-center justify-center text-xs font-semibold",children:e.customer?.name[0]}),(0,t.jsx)("span",{className:"font-medium capitalize",children:e.customer?.name})]})}),(0,t.jsx)(r.TableCell,{className:"py-3 text-dark-text",children:e.id}),(0,t.jsx)(r.TableCell,{className:"py-3 font-medium text-dark-text",children:"+91 "+e.customer?.phone}),(0,t.jsx)(r.TableCell,{className:"py-3 text-dark-text capitalize",children:e.rewardText}),(0,t.jsx)(r.TableCell,{className:"py-3 text-muted-foreground",children:(0,n.FormatLastVisit)(e.createdAt,!0)})]},e.id))})]}),!a&&e?.length===0&&(0,t.jsx)("div",{className:"py-10 text-center text-sm text-muted-foreground",children:"No data found"})]})}e.i(71470);var o=e.i(41721),d=e.i(41019),u=e.i(95775),m=e.i(88997),x=e.i(97447),h=e.i(46696);let f=(0,o.observer)(()=>{let{shopStore:e}=(0,d.useStore)(),[r,l]=(0,a.useState)(""),[i,n]=(0,a.useState)(""),[o,f]=(0,a.useState)([]),[p,b]=(0,a.useState)(1),[g,j]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e.resetPagination()},[]);let y=(0,m.useDebounce)(i,500);return(0,a.useEffect)(()=>{(async()=>{j(!0);try{let t=await fetch("/api/shop/customers/rewardHistory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:e.shop?.id,page:p,limit:e.pagination?.limit,search:y,date:r})}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to fetch rewards");f(a.data),e.updatePagination(a.pagination)}catch(e){console.error("FETCH rewards error:",e),h.toast.error(e.message)}j(!1)})()},[p,e.pagination?.limit,y,r]),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex justify-between",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.SearchBar,{value:i,onChange:n,placeholder:"Search by name or phone... "}),(0,t.jsx)(s.Input,{type:"date",value:r,onChange:e=>l(e.target.value),className:"h-9 text-sm w-auto",style:{background:"linear-gradient(to bottom right, #faf5ff, #ffffff)"}})]})}),(0,t.jsx)(c,{rewardsData:o,loading:g}),(0,t.jsx)(x.default,{page:p,setPage:b})]})});e.s(["default",0,f],84031)}]);