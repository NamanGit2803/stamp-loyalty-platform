module.exports=[81787,a=>{"use strict";var b=a.i(87924);a.i(72131),a.s(["default",0,()=>(0,b.jsxs)("div",{className:"hidden md:flex w-3/5 flex-col justify-center px-16",children:[(0,b.jsxs)("div",{className:"mb-10",children:[(0,b.jsxs)("h2",{className:"text-4xl font-bold text-secondary leading-tight",children:["Grow Your Business",(0,b.jsx)("br",{}),"With Confidence"]}),(0,b.jsx)("p",{className:"text-gray-600 text-lg mt-4",children:"Smart tools that help your shop grow every day."})]}),(0,b.jsx)("img",{src:"/sign-up.svg",alt:"Signup Illustration",className:"w-4/5 max-w-xl drop-shadow-md"})]})])},47982,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(3130),f=a.i(50944);a.i(12180);var g=a.i(12530),h=a.i(73140),i=a.i(77156),j=a.i(41379),k=a.i(18685),l=a.i(40695),m=a.i(5522),n=a.i(23292),o=a.i(88466),p=a.i(70121),q=a.i(50104),r=a.i(7554),s=a.i(25152),t=a.i(77994),u=a.i(3688),v=a.i(77192),w=a.i(30553),x="Checkbox",[y,z]=(0,q.createContextScope)(x),[A,B]=y(x),C=c.forwardRef((a,d)=>{let{__scopeCheckbox:e,name:f,checked:g,defaultChecked:h,required:i,disabled:j,value:k="on",onCheckedChange:l,form:m,...n}=a,[o,q]=c.useState(null),t=(0,p.useComposedRefs)(d,a=>q(a)),u=c.useRef(!1),v=!o||m||!!o.closest("form"),[x=!1,y]=(0,s.useControllableState)({prop:g,defaultProp:h,onChange:l}),z=c.useRef(x);return c.useEffect(()=>{let a=o?.form;if(a){let b=()=>y(z.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[o,y]),(0,b.jsxs)(A,{scope:e,state:x,disabled:j,children:[(0,b.jsx)(w.Primitive.button,{type:"button",role:"checkbox","aria-checked":G(x)?"mixed":x,"aria-required":i,"data-state":H(x),"data-disabled":j?"":void 0,disabled:j,value:k,...n,ref:t,onKeyDown:(0,r.composeEventHandlers)(a.onKeyDown,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,r.composeEventHandlers)(a.onClick,a=>{y(a=>!!G(a)||!a),v&&(u.current=a.isPropagationStopped(),u.current||a.stopPropagation())})}),v&&(0,b.jsx)(F,{control:o,bubbles:!u.current,name:f,value:k,checked:x,required:i,disabled:j,form:m,style:{transform:"translateX(-100%)"},defaultChecked:!G(h)&&h})]})});C.displayName=x;var D="CheckboxIndicator",E=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=B(D,d);return(0,b.jsx)(v.Presence,{present:e||G(g.state)||!0===g.state,children:(0,b.jsx)(w.Primitive.span,{"data-state":H(g.state),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});E.displayName=D;var F=a=>{let{control:d,checked:e,bubbles:f=!0,defaultChecked:g,...h}=a,i=c.useRef(null),j=(0,t.usePrevious)(e),k=(0,u.useSize)(d);c.useEffect(()=>{let a=i.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(j!==e&&b){let c=new Event("click",{bubbles:f});a.indeterminate=G(e),b.call(a,!G(e)&&e),a.dispatchEvent(c)}},[j,e,f]);let l=c.useRef(!G(e)&&e);return(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??l.current,...h,tabIndex:-1,ref:i,style:{...a.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function G(a){return"indeterminate"===a}function H(a){return G(a)?"indeterminate":a?"checked":"unchecked"}var I=a.i(6406),J=a.i(97895);function K({className:a,...c}){return(0,b.jsx)(C,{"data-slot":"checkbox",className:(0,J.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(E,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,b.jsx)(I.CheckIcon,{className:"size-3.5"})})})}let L=(0,g.observer)(({setStep:a})=>{let{userStore:e}=(0,h.useStore)(),[g,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)({}),[u,v]=(0,c.useState)({name:"",email:"",password:"",confirmPassword:"",checkbox:!1}),w=(0,f.useRouter)(),x=a=>{let{name:b,value:c}=a.target;v(a=>({...a,[b]:c})),s[b]&&t(a=>({...a,[b]:""}))},y=async b=>{let c;b.preventDefault();let d=(c={},u.name.trim()||(c.name="Name is required"),u.email.trim()||(c.email="Email is required"),u.email.includes("@")||(c.email="Invalid email"),u.password.length<6&&(c.password="Password must be 6+ characters"),u.password!==u.confirmPassword&&(c.confirmPassword="Passwords do not match"),c);if(Object.keys(d).length>0)return void t(d);if(!1==u.checkbox)return void n.toast.error("Please check the checkbox.");let{confirmPassword:f,...g}=u;if(await e.userSignup({...g,checkOnly:!0}),"User already exists"===e.error)return void n.toast.error(e.error+".",{description:"Please login.",action:{label:"Login",onClick:()=>w.push("/login")}});if("Shop not registered"===e.error){localStorage.setItem("signupStep",2),n.toast.error("Shop not registered yet with this email.",{description:"Please registerd your shop."}),a(2);return}(await e.requestOtp(u.email,"signup"),e.error||(await e.waitForOtp(),await e.userSignup(g),e.error))?n.toast.error(e.error):(v({name:"",email:"",password:"",confirmPassword:""}),localStorage.setItem("signupStep",2),a(2))};return(0,b.jsx)("form",{action:"",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Full Name"}),(0,b.jsx)(m.Input,{type:"text",name:"name",placeholder:"Your name",value:u.name,onChange:x,className:s.name?"border-red-500":"border-border"}),s.name&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"})," ",s.name]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Email"}),(0,b.jsx)(m.Input,{type:"email",name:"email",placeholder:"your@email.com",value:u.email,onChange:x,className:s.email?"border-red-500":"border-border"}),s.email&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"})," ",s.email]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Input,{type:g?"text":"password",name:"password",placeholder:"Minimum 6 characters",value:u.password,onChange:x,className:s.password?"border-red-500 pr-10":"border-border pr-10"}),(0,b.jsx)("button",{type:"button",onClick:()=>p(!g),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-600 hover:text-gray-800",children:g?(0,b.jsx)(j.EyeOff,{size:18}):(0,b.jsx)(i.Eye,{size:18})})]}),s.password&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"})," ",s.password]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Confirm Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Input,{type:q?"text":"password",name:"confirmPassword",placeholder:"Re-enter password",value:u.confirmPassword,onChange:x,className:s.confirmPassword?"border-red-500 pr-10":"border-border pr-10"}),(0,b.jsx)("button",{type:"button",onClick:()=>r(!q),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-600 hover:text-gray-800",children:q?(0,b.jsx)(j.EyeOff,{size:18}):(0,b.jsx)(i.Eye,{size:18})})]}),s.confirmPassword&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"})," ",s.confirmPassword]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,b.jsx)(K,{id:"terms",required:!0,checked:u.checkbox,onCheckedChange:a=>v(b=>({...b,checkbox:!!a}))}),(0,b.jsxs)("label",{htmlFor:"terms",className:"text-gray-600 leading-relaxed cursor-pointer",children:["I agree to the"," ",(0,b.jsx)(d.default,{href:"/terms",className:"text-primary hover:underline",children:"Terms & Conditions"})," ","and"," ",(0,b.jsx)(d.default,{href:"/privacy",className:"text-primary hover:underline",children:"Privacy Policy"})]})]}),(0,b.jsx)(l.Button,{onClick:y,disabled:e.loading,className:"w-full mt-6 text-white hover:cursor-pointer",children:e.loading?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Spinner,{}),"Processing..."]}):"Continue"})]})})});var M=a.i(87682);let N=[{value:"grocery",label:"Grocery"},{value:"salon",label:"Salon"},{value:"cafe & restaurant",label:"Cafe & Restaurant"},{value:"bakery",label:"Bakery"},{value:"clothing",label:"Clothing Store"},{value:"electronics",label:"Electronics"},{value:"gym",label:"Gym / Fitness"},{value:"pharmacy",label:"Pharmacy"},{value:"other",label:"Other"}];var O=a.i(10617);let P=(0,g.observer)(({setStep:a})=>{let{userStore:d,shopStore:e,planStore:g}=(0,h.useStore)(),[i,j]=(0,c.useState)({}),[p,q]=(0,c.useState)({shopName:"",phone:"",upiId:"",businessType:"",customBusinessType:"",address:"",minAmount:"",targetStamp:"",reward:""}),r=(0,f.useRouter)(),s=g.defaultPlan,t=a=>{let{name:b,value:c}=a.target;q(a=>({...a,[b]:c})),i[b]&&j(a=>({...a,[b]:""}))},u=async b=>{var c,f;let g;b.preventDefault();let h=(g={},p.shopName.trim()||(g.shopName="Shopname is required"),p.phone.trim()||(g.phone="Phone is required"),p.upiId.trim()||(g.upiId="UpiId is required"),p.businessType.trim()||(g.businessType="Business type is required"),"other"!=p.businessType||p.customBusinessType.trim()||(g.customBusinessType="Custom business type is required"),p.address.trim()||(g.address="Address is required"),p.minAmount.trim()||(g.minAmount="Minimum amount is required"),p.minAmount.trim().length>0&&(c=p.minAmount,!/^[0-9]+$/.test(c))&&(g.minAmount="Plaese enter valid minimum amount"),p.targetStamp.trim()||(g.targetStamp="Target stamp is required"),p.targetStamp.trim().length>0&&(f=p.targetStamp,!/^[0-9]+$/.test(f))&&(g.minAmount="Plaese enter valid target stamp."),p.reward.trim()||(g.reward="Reward is required"),g);if(Object.keys(h).length>0)return void j(h);let i={...p};if("other"===p.businessType&&(i.businessType=p.customBusinessType),delete i.customBusinessType,!d.user?.email){n.toast.error("User not exist."),a(1),localStorage.setItem("signupStep",1);return}(i.ownerId=d.user.email,await e.createShop(i,s.id),e.error)?"Shop already exists for this user."==e.error?n.toast.error(e.error,{description:"Click the button to login.",action:{label:"Login",onClick:()=>r.push("/login")}}):n.toast.error(e.error):(q({shopName:"",phone:"",businessType:"",customBusinessType:"",upiId:"",address:"",minAmount:"",targetStamp:"",reward:""}),n.toast.success("Welcome aboard! Your shop has been created."),localStorage.removeItem("signupStep"),setTimeout(()=>{r.push(`/shop/${e.shop.id}`)},1500),await fetch("/api/email/sendWelcomeEmail",{method:"POST",body:JSON.stringify({email:d.user?.email,name:d.user?.name,shopName:e.shop?.shopName,trialEndDate:(0,O.FormatToIST)(e.subscription?.trialEndsAt),dashboardUrl:`https://stampi.in/shop/${e.shop?.id}`})}))};return(0,b.jsx)("form",{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Shop Name"}),(0,b.jsx)(m.Input,{type:"text",name:"shopName",placeholder:"Your shop name",value:p.shopName,onChange:t,className:i.shopName?"border-red-500":"border-border"}),i.shopName&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.shopName]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Phone"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"+91"}),(0,b.jsx)(m.Input,{type:"text",name:"phone",placeholder:"XXXXX XXXXX",maxLength:10,value:p.phone,onChange:t,className:`pl-12 ${i.phone?"border-red-500":"border-border"}`})]}),i.phone&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.phone]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Upi Id"}),(0,b.jsx)(m.Input,{type:"text",name:"upiId",placeholder:"Your upi id",value:p.upiId,onChange:t,className:i.upiId?"border-red-500":"border-border"}),i.upiId&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.upiId]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Business Type"}),(0,b.jsxs)(M.Select,{value:p.businessType,onValueChange:a=>{q({...p,businessType:a}),i.businessType&&j(a=>({...a,businessType:""})),"other"!==a&&(q(a=>({...a,customBusinessType:""})),i.customBusinessType&&j(a=>({...a,customBusinessType:""})))},children:[(0,b.jsx)(M.SelectTrigger,{className:`${i.businessType?"border-red-500":"border-border"} w-full `,children:(0,b.jsx)(M.SelectValue,{placeholder:"Select business type"})}),(0,b.jsx)(M.SelectContent,{children:N.map(a=>(0,b.jsx)(M.SelectItem,{value:a.value,children:a.label},a.value))})]}),i.businessType&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.businessType]}),"other"===p.businessType&&(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)(m.Input,{name:"customBusinessType",placeholder:"Enter your business type",value:p.customBusinessType,onChange:t,className:i.customBusinessType?"border-red-500":"border-border"}),i.customBusinessType&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.customBusinessType]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Shop Address"}),(0,b.jsx)(m.Input,{type:"text",name:"address",placeholder:"Shop full address",value:p.address,onChange:t,className:i.address?"border-red-500":"border-border"}),i.address&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.address]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Minimum Amount For A Stamp"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"â‚¹"}),(0,b.jsx)(m.Input,{type:"number",name:"minAmount",placeholder:"0",value:p.minAmount,onChange:t,className:`pl-8 ${i.minAmount?"border-red-500":"border-border"}`})]}),i.minAmount&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.minAmount]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Stamps Required for Reward"}),(0,b.jsx)(m.Input,{type:"number",name:"targetStamp",placeholder:"Enter target stamp.   e.g., 5",value:p.targetStamp,onChange:t,className:i.targetStamp?"border-red-500":"border-border"}),i.targetStamp&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.targetStamp]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-primary mb-2",children:"Reward"}),(0,b.jsx)(m.Input,{type:"text",name:"reward",placeholder:"e.g., Free Coffee",value:p.reward,onChange:t,className:i.reward?"border-red-500":"border-border"}),i.reward&&(0,b.jsxs)("p",{className:"text-red-600 text-xs mt-1 flex gap-2 items-center",children:[(0,b.jsx)(k.TriangleAlert,{className:"h-3 w-3"}),i.reward]})]}),(0,b.jsx)(l.Button,{onClick:u,className:"w-full hover:cursor-pointer text-white",disabled:e.loading,children:e.loading?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Spinner,{}),"Processing..."]}):"Continue"})]})})}),Q=(0,g.observer)(()=>{let{userStore:a,planStore:g}=(0,h.useStore)(),[i,j]=(0,c.useState)(1);return(0,f.useRouter)(),(0,c.useEffect)(()=>{localStorage.getItem("signupStep")&&j(localStorage.getItem("signupStep")),a.user||localStorage.removeItem("signupStep"),g.loadPlans()},[]),(0,b.jsx)("div",{className:"flex w-full md:w-2/5 items-center justify-center p-4 h-screen overflow-y-hidden",children:(0,b.jsx)(e.Card,{className:"w-full max-w-md shadow-lg border-blue-100 p-0 h-[90%] overflow-y-auto no-scrollbar",children:(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-secondary mb-2",children:1==i?"Create Account":"Enter Shop Details"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:1==i?"Join thousands of shopkeepers managing loyalty":"Provide your shop information to continue."}),2==i&&a.user&&(0,b.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Your email: ",(0,b.jsx)("span",{className:"text-primary",children:a.user?.email})]})]}),(0,b.jsx)("div",{className:"flex gap-2 mb-7",children:[1,2].map(a=>(0,b.jsx)("div",{className:`h-1 flex-1 rounded-full transition-colors ${a<=i?"bg-secondary":"bg-gray-200"}`},a))}),(0,b.jsx)("div",{children:1==i?(0,b.jsx)(L,{setStep:j}):(0,b.jsx)(P,{setStep:j})}),(0,b.jsxs)("p",{className:"text-center text-sm text-gray-600 mt-6",children:[2==i?"Want to signup with another email? ":"Already have an account? ",2==i?(0,b.jsx)("span",{className:"hover:cursor-pointer text-primary hover:underline",onClick:()=>{localStorage.setItem("signupStep",1),j(1)},children:"Sign up"}):(0,b.jsx)(d.default,{href:"/login",className:"text-primary hover:underline",children:"Sign in"})]})]})})})});a.s(["default",0,Q],47982)}];

//# sourceMappingURL=components_auth_signup_f4aad478._.js.map